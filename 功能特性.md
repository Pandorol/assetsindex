# 📋 AssetsIndex 功能特性详解

## 🎯 核心功能概览

### 1. 📊 智能资源分析
- **预制体依赖分析**：自动分析预制体与图片资源的引用关系
- **资源统计**：统计图片数量、大小、使用频率等信息
- **重复检测**：基于 MD5 算法识别完全相同的图片文件
- **分类识别**：按使用模式自动分类资源（背景图、通用图、独占图等）

### 2. 🔧 灵活配置系统
- **正则匹配**：支持复杂的路径匹配规则
- **阈值设置**：可自定义大图、小图、通用图的判断标准
- **路径模板**：支持变量替换的目标路径配置
- **冲突策略**：多种文件冲突处理方案

### 3. 🚀 批量操作能力
- **预览模式**：操作前可预览所有将要执行的变更
- **批量移动**：支持同时处理数百个文件的移动操作
- **引用更新**：自动更新预制体中的资源引用关系
- **进度跟踪**：实时显示操作进度和状态

## 🛠️ 详细功能特性

### 资源分析引擎

#### 🔍 深度扫描能力
```
✓ 扫描所有 .prefab 文件
✓ 解析 JSON 和正则双重模式
✓ 提取 spriteFrame 引用关系
✓ 生成完整的依赖图
✓ 计算资源使用统计
```

#### 📈 多维度统计
```
✓ 按引用次数分类
✓ 按文件大小分类  
✓ 按图片尺寸分类
✓ 按目录结构分类
✓ 按使用模式分类
```

### 智能分类系统

#### 🖼️ 图片类型识别
| 类型 | 判断标准 | 应用场景 |
|------|----------|----------|
| 大图/背景图 | 尺寸 > 500x500px | 场景背景、大型UI背景 |
| 通用图 | 引用次数 ≥ 3 | 按钮、图标、通用UI元素 |
| 单独图 | 仅被1个预制体引用 | 特定界面的专用图片 |
| 同目录图 | 位于相同目录 | 相关功能的图片组 |
| 小小图 | 尺寸 < 50x50px | 小图标、装饰元素 |
| 重复图 | MD5相同 | 需要合并的重复文件 |

#### 🎨 高级分类特性
```
✓ 支持AND/OR逻辑组合判断
✓ 可按宽度、高度、面积单独或组合判断
✓ 支持正则表达式排除规则
✓ 可自定义分类阈值
✓ 支持忽略列表功能
```

### 路径规则引擎

#### 🗂️ 灵活的路径匹配
```
支持的正则表达式特性：
✓ 捕获组：(.*?) 匹配任意内容
✓ 非贪婪匹配：.*? 最短匹配
✓ 字符类：[a-zA-Z0-9] 匹配特定字符
✓ 量词：+ * ? {n,m} 控制匹配次数
✓ 边界：^ $ 匹配开始和结束
```

#### 🎯 目标路径生成
```
变量替换系统：
✓ $1, $2, $3... 捕获组内容替换
✓ 路径分隔符自动标准化
✓ 支持多级目录创建
✓ 自动处理路径冲突
```

### 文件操作系统

#### 📁 目录管理
```
✓ 自动创建多级目录结构
✓ 处理大小写冲突
✓ 检测目录权限
✓ 清理空目录
```

#### 🔄 文件移动/复制
```
✓ 支持移动和复制两种模式
✓ 自动处理文件名冲突
✓ 支持重命名策略
✓ 批量操作优化
✓ 超时保护机制
```

#### 🔗 引用关系更新
```
✓ 动态UUID检测
✓ 预制体内容解析
✓ 批量引用替换
✓ 引用完整性验证
✓ 错误回滚机制
```

### 冲突处理机制

#### 📂 目录冲突处理
| 策略 | 说明 | 适用场景 |
|------|------|----------|
| 保持旧名称 | 使用已存在的目录名 | 保守策略，避免影响现有结构 |
| 使用新名称 | 重命名现有目录 | 需要标准化目录命名 |

#### 📄 文件冲突处理  
| 策略 | 说明 | 风险等级 |
|------|------|----------|
| 跳过 | 保留现有文件 | 🟢 低风险 |
| 覆盖 | 删除现有文件 | 🔴 高风险 |
| 重命名 | 自动添加后缀 | 🟡 中风险 |

### 性能优化特性

#### ⚡ 高效处理
```
✓ 多线程文件操作
✓ 分批处理大量文件
✓ 内存使用优化
✓ 进度实时反馈
✓ 超时保护机制
```

#### 🔄 错误恢复
```
✓ 操作失败自动重试
✓ 部分失败继续执行
✓ 详细错误日志
✓ 状态恢复机制
```

### 用户体验特性

#### 👀 预览功能
```
✓ 操作前完整预览
✓ 影响范围评估
✓ 冲突提前检测
✓ 磁盘空间计算
✓ 风险等级提示
```

#### 📊 进度跟踪
```
✓ 实时进度显示
✓ 操作状态反馈
✓ 剩余时间估算
✓ 错误计数统计
✓ 成功率监控
```

#### 🎛️ 界面友好
```
✓ 标签页分类组织
✓ 表格数据展示
✓ 配置参数保存
✓ 一键式操作
✓ 快捷键支持
```

## 🔧 技术规格

### 支持的文件格式
- **图片**：.png, .jpg, .jpeg
- **预制体**：.prefab
- **元数据**：.meta

### 性能指标
- **扫描速度**：~1000 文件/秒
- **移动速度**：~50 文件/秒  
- **内存使用**：< 100MB（中型项目）
- **支持规模**：10000+ 文件

### 兼容性
- **Cocos Creator**：>= 3.7.4
- **操作系统**：Windows, macOS, Linux
- **Node.js**：>= 16.0.0

### 安全特性
- ✅ 操作前数据验证
- ✅ 文件完整性检查
- ✅ 引用关系验证
- ✅ 回滚机制支持
- ✅ 备份建议提示

## 🎯 应用场景

### 📱 移动游戏优化
- 按场景分离资源减少包体
- 合并重复资源节省空间
- 优化资源加载顺序

### 🎮 PC游戏管理
- 模块化资源组织
- 动态加载资源分类
- 版本更新资源管理

### 🌐 Web游戏部署
- 资源CDN部署优化
- 分包加载策略
- 缓存策略优化

---

💡 **设计理念**：通过自动化工具减少手工维护成本，提高项目资源管理效率，降低人为错误风险。
